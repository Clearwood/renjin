
library(hamcrest)

test.hclust <- function() {

    USArrests <- data.frame(
        Murder = c(13.2, 10, 8.1, 8.8, 9, 7.9, 3.3, 5.9,  15.4, 17.4, 5.3, 2.6, 10.4, 7.2, 2.2, 6, 9.7, 15.4, 2.1, 
                    11.3,  4.4, 12.1, 2.7, 16.1, 9, 6, 4.3, 12.2, 2.1, 7.4, 11.4, 11.1,  13, 0.8, 7.3, 6.6, 4.9, 6.3,
                    3.4, 14.4, 3.8, 13.2, 12.7, 3.2,  2.2, 8.5, 4, 5.7, 2.6, 6.8), 
        Assault = c(236L, 263L, 294L, 190L,  276L, 204L, 110L, 238L, 335L, 211L, 46L, 120L, 249L, 113L, 56L,  115L, 
                    109L, 249L, 83L, 300L, 149L, 255L, 72L, 259L, 178L, 109L,  102L, 252L, 57L, 159L, 285L, 254L, 337L, 
                    45L, 120L, 151L, 159L,  106L, 174L, 279L, 86L, 188L, 201L, 120L, 48L, 156L, 145L, 81L,  53L, 161L), 
                    
        UrbanPop = c(58L, 48L, 80L, 50L, 91L, 78L, 77L, 72L,  80L, 60L, 83L, 54L, 83L, 65L, 57L, 66L, 52L, 66L, 51L,
                    67L, 85L,  74L, 66L, 44L, 70L, 53L, 62L, 81L, 56L, 89L, 70L, 86L, 45L, 44L,  75L, 68L, 67L, 72L,
                    87L, 48L, 45L, 59L, 80L, 80L, 32L, 63L, 73L,  39L, 66L, 60L),
                     
        Rape = c(21.2, 44.5, 31, 19.5, 40.6, 38.7, 11.1,  15.8, 31.9, 25.8, 20.2, 14.2, 24, 21, 11.3, 18, 16.3, 22.2, 
                    7.8,  27.8, 16.3, 35.1, 14.9, 17.1, 28.2, 16.4, 16.5, 46, 9.5, 18.8,  32.1, 26.1, 16.1, 7.3, 21.4, 
                    20, 29.3, 14.9, 8.3, 22.5, 12.8,  26.9, 25.5, 22.9, 11.2, 20.7, 26.2, 9.3, 10.8, 15.6))
    hc <- hclust(dist(USArrests), "ave")
    
    expectedMerge <- cbind(
            as.integer(c(-15, -17, -14, -13, -35, -36, -7, -19, -49, -50, -48, -21,  -27, -4, -37, -34, -22, 3, -3, 
                -6, -12,  5, -20, -1, -47, -8,  4, -23, -25, 21, -24, -39, -10, 26, 25, 16, -5, -2, 29, 11, -9,
                34, -11, 37,  35, 30, 41, 45, 47)),
            as.integer(c(-29, -26, -16, -32, -44, -46, -38, -41, 1, 6, 8, -30, 2, -42,  10, -45, -28, 7, -31, -43,
             13, 18, 19, -18, 15, 24, 17, 9, 14,  22, -40, 12, 20, 27, 32, 28, 23, 31, 33, 36, -33, 38, 40, 42,  39, 
             43, 44, 46, 48)))
              
    assertThat(hc$merge, identicalTo(expectedMerge))
}