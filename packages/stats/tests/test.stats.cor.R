library(hamcrest)

test.stats.cor.0 <- function() {
    expected <- 0x1.ffffffffffffep-1 
    assertThat(stats:::cor(x = 1:10, y = 2:11), equalTo(expected))
}


test.stats.cor.1 <- function() {
    expected <- structure(c(0x1p+0, 0x1.fbb193a55e301p-1, 0x1.3dc3a8f7b1965p-1, 
		0x1.dbe5e67b01029p-2, 0x1.f554e8d427a68p-1, 0x1.fb77e81997505p-1, 
		0x1.f1199c89be65fp-1, 0x1.fbb193a55e301p-1, 0x1p+0, 0x1.3561b09e26d8dp-1, 
		0x1.c926b9f3a3d42p-2, 0x1.fb7028576dd6cp-1, 0x1.fd947c6eb1048p-1, 
		0x1.f79413a7e3bb4p-1, 0x1.3dc3a8f7b1965p-1, 0x1.3561b09e26d8dp-1, 
		0x1p+0, -0x1.6b5b81cac5391p-3, 0x1.5f83ae2b9dcfap-1, 0x1.5625bacbdc705p-1, 
		0x1.01476dc919a17p-1, 0x1.dbe5e67b01029p-2, 0x1.c926b9f3a3d42p-2, 
		-0x1.6b5b81cac5391p-3, 0x1p+0, 0x1.752989b6d443bp-2, 0x1.ab425003d2a5dp-2, 
		0x1.d448641c789bep-2, 0x1.f554e8d427a68p-1, 0x1.fb7028576dd6cp-1, 
		0x1.5f83ae2b9dcfap-1, 0x1.752989b6d443bp-2, 0x1p+0, 0x1.fce76330ac4dfp-1, 
		0x1.ebb85020c4e8fp-1, 0x1.fb77e81997505p-1, 0x1.fd947c6eb1048p-1, 
		0x1.5625bacbdc705p-1, 0x1.ab425003d2a5dp-2, 0x1.fce76330ac4dfp-1, 
		0x1p+0, 0x1.f1521849be377p-1, 0x1.f1199c89be65fp-1, 0x1.f79413a7e3bb4p-1, 
		0x1.01476dc919a17p-1, 0x1.d448641c789bep-2, 0x1.ebb85020c4e8fp-1, 
		0x1.f1521849be377p-1, 0x1p+0), .Dim = c(7L, 7L), .Dimnames = list(
    	c("GNP.deflator", "GNP", "Unemployed", "Armed.Forces", "Population", 
    	"Year", "Employed"), c("GNP.deflator", "GNP", "Unemployed", 
    	"Armed.Forces", "Population", "Year", "Employed"))) 

    assertThat(stats:::cor(x = structure(list(GNP.deflator = c(83,
        88.5, 88.2, 89.5, 96.2, 98.1, 99, 100, 101.2, 104.6,
        108.4, 110.8, 112.6, 114.2, 115.7, 116.9), GNP = c(234.289,
        259.426, 258.054, 284.599, 328.975, 346.999, 365.385,
        363.112, 397.469, 419.18, 442.769, 444.546, 482.704,
        502.601, 518.173, 554.894), Unemployed = c(235.6, 232.5,
        368.2, 335.1, 209.9, 193.2, 187, 357.8, 290.4, 282.2,
        293.6, 468.1, 381.3, 393.1, 480.6, 400.7), Armed.Forces = c(159,
        145.6, 161.6, 165, 309.9, 359.4, 354.7, 335, 304.8, 285.7,
        279.8, 263.7, 255.2, 251.4, 257.2, 282.7), Population = c(107.608,
        108.632, 109.773, 110.929, 112.075, 113.27, 115.094,
        116.219, 117.388, 118.734, 120.445, 121.95, 123.366,
        125.368, 127.852, 130.081), Year = 1947:1962, Employed = c(60.323,
        61.122, 60.171, 61.187, 63.221, 63.639, 64.989, 63.761,
        66.019, 67.857, 68.169, 66.513, 68.655, 69.564, 69.331,
        70.551)), .Names = c("GNP.deflator", "GNP", "Unemployed",
        "Armed.Forces", "Population", "Year", "Employed"), row.names = 1947:1962,
        class = "data.frame")), identicalTo(expected, tol = 1e-6))
}


test.stats.cor.2 <- function() {
    expected <- structure(c(0x1p+0, 0x1.fe7e7e7e7e7e8p-1, 0x1.5454545454545p-1, 
		0x1.c3c3c3c3c3c3cp-3, 0x1.fe7e7e7e7e7e8p-1, 0x1.fe7e7e7e7e7e8p-1, 
		0x1.f6f6f6f6f6f6fp-1, 0x1.fe7e7e7e7e7e8p-1, 0x1p+0, 0x1.46c6c6c6c6c6cp-1, 
		0x1.c9c9c9c9c9c9cp-3, 0x1.fcfcfcfcfcfdp-1, 0x1.fcfcfcfcfcfdp-1, 
		0x1.f878787878787p-1, 0x1.5454545454545p-1, 0x1.46c6c6c6c6c6cp-1, 
		0x1p+0, -0x1.5d5d5d5d5d5d6p-2, 0x1.5edededededeep-1, 0x1.5edededededeep-1, 
		0x1.2121212121212p-1, 0x1.c3c3c3c3c3c3cp-3, 0x1.c9c9c9c9c9c9cp-3, 
		-0x1.5d5d5d5d5d5d6p-2, 0x1p+0, 0x1.cfcfcfcfcfcfdp-3, 0x1.cfcfcfcfcfcfdp-3, 
		0x1.cfcfcfcfcfcfdp-3, 0x1.fe7e7e7e7e7e8p-1, 0x1.fcfcfcfcfcfdp-1, 
		0x1.5edededededeep-1, 0x1.cfcfcfcfcfcfdp-3, 0x1p+0, 0x1p+0, 0x1.f3f3f3f3f3f3fp-1, 
		0x1.fe7e7e7e7e7e8p-1, 0x1.fcfcfcfcfcfdp-1, 0x1.5edededededeep-1, 
		0x1.cfcfcfcfcfcfdp-3, 0x1p+0, 0x1p+0, 0x1.f3f3f3f3f3f3fp-1, 0x1.f6f6f6f6f6f6fp-1, 
		0x1.f878787878787p-1, 0x1.2121212121212p-1, 0x1.cfcfcfcfcfcfdp-3, 
		0x1.f3f3f3f3f3f3fp-1, 0x1.f3f3f3f3f3f3fp-1, 0x1p+0), .Dim = c(7L, 
		7L), .Dimnames = list(c("GNP.deflator", "GNP", "Unemployed", 
		"Armed.Forces", "Population", "Year", "Employed"), c("GNP.deflator", 
		"GNP", "Unemployed", "Armed.Forces", "Population", "Year", "Employed"
		))) 
    assertThat(stats:::cor(method = "spearman", x = structure(list(GNP.deflator = c(83,
        88.5, 88.2, 89.5, 96.2, 98.1, 99, 100, 101.2, 104.6,
        108.4, 110.8, 112.6, 114.2, 115.7, 116.9), GNP = c(234.289,
        259.426, 258.054, 284.599, 328.975, 346.999, 365.385,
        363.112, 397.469, 419.18, 442.769, 444.546, 482.704,
        502.601, 518.173, 554.894), Unemployed = c(235.6, 232.5,
        368.2, 335.1, 209.9, 193.2, 187, 357.8, 290.4, 282.2,
        293.6, 468.1, 381.3, 393.1, 480.6, 400.7), Armed.Forces = c(159,
        145.6, 161.6, 165, 309.9, 359.4, 354.7, 335, 304.8, 285.7,
        279.8, 263.7, 255.2, 251.4, 257.2, 282.7), Population = c(107.608,
        108.632, 109.773, 110.929, 112.075, 113.27, 115.094,
        116.219, 117.388, 118.734, 120.445, 121.95, 123.366,
        125.368, 127.852, 130.081), Year = 1947:1962, Employed = c(60.323,
        61.122, 60.171, 61.187, 63.221, 63.639, 64.989, 63.761,
        66.019, 67.857, 68.169, 66.513, 68.655, 69.564, 69.331,
        70.551)), .Names = c("GNP.deflator", "GNP", "Unemployed",
        "Armed.Forces", "Population", "Year", "Employed"), row.names = 1947:1962,
        class = "data.frame")), identicalTo(expected, tol = 1e-6))
}


test.stats.cor.3 <- function() {
    expected <- structure(c(0x1p+0, 0x1.f777777777776p-1, 0x1.cccccccccccccp-2, 
		0x1.111111111111p-5, 0x1.f777777777776p-1, 0x1.f777777777776p-1, 
		0x1.d555555555554p-1, 0x1.f777777777776p-1, 0x1p+0, 0x1.bbbbbbbbbbbbbp-2, 
		0x1.9999999999999p-5, 0x1.eeeeeeeeeeeeep-1, 0x1.eeeeeeeeeeeeep-1, 
		0x1.dddddddddddddp-1, 0x1.cccccccccccccp-2, 0x1.bbbbbbbbbbbbbp-2, 
		0x1p+0, -0x1.bbbbbbbbbbbbbp-3, 0x1.dddddddddddddp-2, 0x1.dddddddddddddp-2, 
		0x1.7777777777777p-2, 0x1.111111111111p-5, 0x1.9999999999999p-5, 
		-0x1.bbbbbbbbbbbbbp-3, 0x1p+0, 0x1.9999999999999p-5, 0x1.9999999999999p-5, 
		0x1.9999999999999p-5, 0x1.f777777777776p-1, 0x1.eeeeeeeeeeeeep-1, 
		0x1.dddddddddddddp-2, 0x1.9999999999999p-5, 0x1p+0, 0x1.fffffffffffffp-1, 
		0x1.cccccccccccccp-1, 0x1.f777777777776p-1, 0x1.eeeeeeeeeeeeep-1, 
		0x1.dddddddddddddp-2, 0x1.9999999999999p-5, 0x1.fffffffffffffp-1, 
		0x1p+0, 0x1.cccccccccccccp-1, 0x1.d555555555554p-1, 0x1.dddddddddddddp-1, 
		0x1.7777777777777p-2, 0x1.9999999999999p-5, 0x1.cccccccccccccp-1, 
		0x1.cccccccccccccp-1, 0x1p+0), .Dim = c(7L, 7L), .Dimnames = list(
    	c("GNP.deflator", "GNP", "Unemployed", "Armed.Forces", "Population", 
    	"Year", "Employed"), c("GNP.deflator", "GNP", "Unemployed", 
    	"Armed.Forces", "Population", "Year", "Employed"))) 
    assertThat(stats:::cor(method = "kendall", x = structure(list(GNP.deflator = c(83,
        88.5, 88.2, 89.5, 96.2, 98.1, 99, 100, 101.2, 104.6,
        108.4, 110.8, 112.6, 114.2, 115.7, 116.9), GNP = c(234.289,
        259.426, 258.054, 284.599, 328.975, 346.999, 365.385,
        363.112, 397.469, 419.18, 442.769, 444.546, 482.704,
        502.601, 518.173, 554.894), Unemployed = c(235.6, 232.5,
        368.2, 335.1, 209.9, 193.2, 187, 357.8, 290.4, 282.2,
        293.6, 468.1, 381.3, 393.1, 480.6, 400.7), Armed.Forces = c(159,
        145.6, 161.6, 165, 309.9, 359.4, 354.7, 335, 304.8, 285.7,
        279.8, 263.7, 255.2, 251.4, 257.2, 282.7), Population = c(107.608,
        108.632, 109.773, 110.929, 112.075, 113.27, 115.094,
        116.219, 117.388, 118.734, 120.445, 121.95, 123.366,
        125.368, 127.852, 130.081), Year = 1947:1962, Employed = c(60.323,
        61.122, 60.171, 61.187, 63.221, 63.639, 64.989, 63.761,
        66.019, 67.857, 68.169, 66.513, 68.655, 69.564, 69.331,
        70.551)), .Names = c("GNP.deflator", "GNP", "Unemployed",
        "Armed.Forces", "Population", "Year", "Employed"), row.names = 1947:1962,
        class = "data.frame")), identicalTo(expected, tol = 1e-6))
}


test.stats.cor.4 <- function() {
    expected <- structure(c(0x1p+0, 0x1.f5e1e27737b18p-1, 0x1.ea1d7d73834cfp-1, 
		0x1.f5e1e27737b18p-1, 0x1p+0, 0x1.f2cc94639de19p-1, 0x1.ea1d7d73834cfp-1, 
		0x1.f2cc94639de19p-1, 0x1p+0), .Dim = c(3L, 3L), .Dimnames = list(
    	c("P", "S", "K"), c("P", "S", "K"))) 
    assertThat(stats:::cor(x = structure(c(0.991589178024782,
        0.620633392559097, 0.464744187600675, 0.979163432977498,
        0.991149190067205, 0.970898525061056, 0.604260939889558,
        0.446436791892627, 0.991090069458477, 0.995273483764785,
        0.983551611179669, -0.177420629501878, 0.686551516365312,
        0.668256604562175, 0.502498083875994, 0.364416267189032,
        0.417245149834945, 0.457307399976482, 0.993952846232926,
        0.960390571594376, 0.971329459192119, 0.997058823529412,
        0.664705882352941, 0.220588235294118, 0.997058823529412,
        0.997058823529412, 0.982352941176471, 0.638235294117647,
        0.223529411764706, 0.994117647058824, 0.994117647058824,
        0.985294117647059, -0.341176470588235, 0.685294117647059,
        0.685294117647059, 0.564705882352941, 0.226470588235294,
        0.226470588235294, 0.226470588235294, 1, 0.976470588235294,
        0.976470588235294, 0.983333333333333, 0.45, 0.0333333333333333,
        0.983333333333333, 0.983333333333333, 0.916666666666667,
        0.433333333333333, 0.05, 0.966666666666667, 0.966666666666667,
        0.933333333333333, -0.216666666666667, 0.466666666666667,
        0.466666666666667, 0.366666666666667, 0.05, 0.05, 0.05,
        1, 0.9, 0.9), .Dim = c(21L, 3L), .Dimnames = list(NULL,
        c("P", "S", "K")))), identicalTo(expected, tol = 1e-6))
}


test.stats.cor.6 <- function() {
    expected <- structure(c(0x1p+0, 0x1.950d256bbf0bap-3, -0x1.ff4352aba828dp-2, 
		-0x1.6d368f7385c77p-2, 0x1.fb1fb1fb1fb21p-3, 0x1.23f3fc283fep-2, 
		0x1.950d256bbf0bap-3, 0x1p+0, -0x1.e366bac716e6dp-2, -0x1.db319b746f6a2p-2, 
		0x1.d1b364857658ap-3, -0x1.9dbe942dc73b2p-4, -0x1.ff4352aba828dp-2, 
		-0x1.e366bac716e6dp-2, 0x1p+0, 0x1.144a7dba9244ap-1, -0x1.66e0be2d4c045p-2, 
		-0x1.cdd04cc7d64a1p-7, -0x1.6d368f7385c77p-2, -0x1.db319b746f6a2p-2, 
		0x1.144a7dba9244ap-1, 0x1p+0, -0x1.f2d3e327271cep-4, 0x1.1e908c2c3998cp-6, 
		0x1.fb1fb1fb1fb21p-3, 0x1.d1b364857658ap-3, -0x1.66e0be2d4c045p-2, 
		-0x1.f2d3e327271cep-4, 0x1p+0, 0x1.057354707655fp-4, 0x1.23f3fc283fep-2, 
		-0x1.9dbe942dc73b2p-4, -0x1.cdd04cc7d64a1p-7, 0x1.1e908c2c3998cp-6, 
		0x1.057354707655fp-4, 0x1p+0), .Dim = c(6L, 6L), .Dimnames = list(
    	c("Frtlty", "Agrclt", "Exmntn", "Eductn", "Cathlc", "Infn.M"
    	), c("Frtlty", "Agrclt", "Exmntn", "Eductn", "Cathlc", "Infn.M"
    	))) 
    assertThat(stats:::cor(method = "kendall", use = "complete",
        x = structure(list(Frtlty = c(80.2, 83.1, 92.5, 85.8,
            76.9, 76.1, 83.8, 92.4, 82.4, 82.9, 87.1, 64.1, 66.9,
            68.9, 61.7, 68.3, 71.7, 55.7, 54.3, 65.1, 65.5, 65,
            56.6, 57.4, 72.5, 74.2, 72, 60.5, 58.3, 65.4, 75.5,
            69.3, 77.3, 70.5, 79.4, 65, 92.2, 79.3, 70.4, 65.7,
            72.7, 64.4, 77.6, 67.6, 35, 44.7, 42.8), Agrclt = c(NA,
            45.1, 39.7, 36.5, 43.5, 35.3, 70.2, 67.8, 53.3, 45.2,
            64.5, 62, 67.5, 60.7, 69.3, 72.6, 34, 19.4, 15.2,
            73, 59.8, 55.1, 50.9, 54.1, 71.2, 58.1, 63.5, 60.8,
            26.8, 49.5, 85.9, 84.9, 89.7, 78.2, 64.9, 75.9, 84.6,
            63.1, 38.4, 7.7, 16.7, 17.6, 37.6, 18.7, 1.2, 46.6,
            27.7), Exmntn = c(15L, 6L, 5L, 12L, 17L, 9L, NA,
            14L, 12L, 16L, 14L, 21L, 14L, 19L, 22L, 18L, 17L,
            26L, 31L, 19L, 22L, 14L, 22L, 20L, 12L, 14L, 6L,
            16L, 25L, 15L, 3L, 7L, 5L, 12L, 7L, 9L, 3L, 13L,
            26L, 29L, 22L, 35L, 15L, 25L, 37L, 16L, 22L), Eductn = c(12L,
            9L, 5L, 7L, 15L, 7L, 7L, 8L, 7L, 13L, 6L, 12L, 7L,
            12L, 5L, 2L, 8L, 28L, 20L, 9L, 10L, 3L, 12L, 6L,
            1L, 8L, 3L, 10L, 19L, 8L, 2L, 6L, 2L, 6L, 3L, 9L,
            3L, 13L, 12L, 11L, 13L, 32L, 7L, 7L, 53L, 29L, 29L),
            Cathlc = c(9.96, 84.84, 93.4, 33.77, 5.16, 90.57,
                92.85, 97.16, 97.67, 91.38, 98.61, 8.52, 2.27,
                4.43, 2.82, 24.2, 3.3, 12.11, 2.15, 2.84, 5.23,
                4.52, 15.14, 4.2, NA, 5.23, 2.56, 7.72, 18.46,
                6.1, 99.71, 99.68, 100, 98.96, 98.22, 99.06,
                99.46, 96.83, 5.62, 13.79, 11.22, 16.92, 4.97,
                8.65, 42.34, 50.43, 58.33), Infn.M = c(22.2,
                22.2, 20.2, 20.3, 20.6, 26.6, 23.6, 24.9, 21,
                24.4, 24.5, 16.5, 19.1, 22.7, 18.7, 21.2, 20,
                20.2, 10.8, 20, 18, 22.4, 16.7, 15.3, 21, 23.8,
                18, 16.3, 20.9, 22.5, 15.1, 19.8, 18.3, 19.4,
                20.2, 17.8, 16.3, 18.1, 20.3, 20.5, 18.9, 23,
                20, 19.5, 18, 18.2, 19.3)), .Names = c("Frtlty",
            "Agrclt", "Exmntn", "Eductn", "Cathlc", "Infn.M"),
            row.names = c("Courtelary", "Delemont", "Franches-Mnt",
                "Moutier", "Neuveville", "Porrentruy", "Broye",
                "Glane", "Gruyere", "Sarine", "Veveyse", "Aigle",
                "Aubonne", "Avenches", "Cossonay", "Echallens",
                "Grandson", "Lausanne", "La Vallee", "Lavaux",
                "Morges", "Moudon", "Nyone", "Orbe", "Oron",
                "Payerne", "Paysd'enhaut", "Rolle", "Vevey",
                "Yverdon", "Conthey", "Entremont", "Herens",
                "Martigwy", "Monthey", "St Maurice", "Sierre",
                "Sion", "Boudry", "La Chauxdfnd", "Le Locle",
                "Neuchatel", "Val de Ruz", "ValdeTravers", "V. De Geneve",
                "Rive Droite", "Rive Gauche"), class = "data.frame")),
        identicalTo(expected, tol = 1e-6))
}


test.stats.cor.7 <- function() {
    expected <- structure(c(0x1p+0, 0x1.a7a7ea7f286fcp-3, -0x1.f5ffc0df14aa1p-2, 
		-0x1.528bbb76e6da1p-2, 0x1.0a6600fd86308p-2, 0x1.4339115a45581p-2, 
		0x1.a7a7ea7f286fcp-3, 0x1p+0, -0x1.eabb9657d6105p-2, -0x1.e478707728d87p-2, 
		0x1.f6f1ea98581c5p-3, -0x1.12a9df287559dp-4, -0x1.f5ffc0df14aa1p-2, 
		-0x1.eabb9657d6105p-2, 0x1.fffffffffffffp-1, 0x1.1162817f7db2fp-1, 
		-0x1.63a46480e0be4p-2, -0x1.c727aef21d123p-6, -0x1.528bbb76e6da1p-2, 
		-0x1.e478707728d87p-2, 0x1.1162817f7db2fp-1, 0x1p+0, -0x1.0b56a7a93e759p-3, 
		-0x1.78be44ff8d67ep-9, 0x1.0a6600fd86308p-2, 0x1.f6f1ea98581c5p-3, 
		-0x1.63a46480e0be4p-2, -0x1.0b56a7a93e759p-3, 0x1p+0, 0x1.26b58925c798ap-4, 
		0x1.4339115a45581p-2, -0x1.12a9df287559dp-4, -0x1.c727aef21d123p-6, 
		-0x1.78be44ff8d67ep-9, 0x1.26b58925c798ap-4, 0x1.ffffffffffffep-1
		), .Dim = c(6L, 6L), .Dimnames = list(c("Frtlty", "Agrclt", "Exmntn", 
		"Eductn", "Cathlc", "Infn.M"), c("Frtlty", "Agrclt", "Exmntn", 
		"Eductn", "Cathlc", "Infn.M"))) 
    assertThat(stats:::cor(method = "kendall", use = "pairwise",
        x = structure(list(Frtlty = c(80.2, 83.1, 92.5, 85.8,
            76.9, 76.1, 83.8, 92.4, 82.4, 82.9, 87.1, 64.1, 66.9,
            68.9, 61.7, 68.3, 71.7, 55.7, 54.3, 65.1, 65.5, 65,
            56.6, 57.4, 72.5, 74.2, 72, 60.5, 58.3, 65.4, 75.5,
            69.3, 77.3, 70.5, 79.4, 65, 92.2, 79.3, 70.4, 65.7,
            72.7, 64.4, 77.6, 67.6, 35, 44.7, 42.8), Agrclt = c(NA,
            45.1, 39.7, 36.5, 43.5, 35.3, 70.2, 67.8, 53.3, 45.2,
            64.5, 62, 67.5, 60.7, 69.3, 72.6, 34, 19.4, 15.2,
            73, 59.8, 55.1, 50.9, 54.1, 71.2, 58.1, 63.5, 60.8,
            26.8, 49.5, 85.9, 84.9, 89.7, 78.2, 64.9, 75.9, 84.6,
            63.1, 38.4, 7.7, 16.7, 17.6, 37.6, 18.7, 1.2, 46.6,
            27.7), Exmntn = c(15L, 6L, 5L, 12L, 17L, 9L, NA,
            14L, 12L, 16L, 14L, 21L, 14L, 19L, 22L, 18L, 17L,
            26L, 31L, 19L, 22L, 14L, 22L, 20L, 12L, 14L, 6L,
            16L, 25L, 15L, 3L, 7L, 5L, 12L, 7L, 9L, 3L, 13L,
            26L, 29L, 22L, 35L, 15L, 25L, 37L, 16L, 22L), Eductn = c(12L,
            9L, 5L, 7L, 15L, 7L, 7L, 8L, 7L, 13L, 6L, 12L, 7L,
            12L, 5L, 2L, 8L, 28L, 20L, 9L, 10L, 3L, 12L, 6L,
            1L, 8L, 3L, 10L, 19L, 8L, 2L, 6L, 2L, 6L, 3L, 9L,
            3L, 13L, 12L, 11L, 13L, 32L, 7L, 7L, 53L, 29L, 29L),
            Cathlc = c(9.96, 84.84, 93.4, 33.77, 5.16, 90.57,
                92.85, 97.16, 97.67, 91.38, 98.61, 8.52, 2.27,
                4.43, 2.82, 24.2, 3.3, 12.11, 2.15, 2.84, 5.23,
                4.52, 15.14, 4.2, NA, 5.23, 2.56, 7.72, 18.46,
                6.1, 99.71, 99.68, 100, 98.96, 98.22, 99.06,
                99.46, 96.83, 5.62, 13.79, 11.22, 16.92, 4.97,
                8.65, 42.34, 50.43, 58.33), Infn.M = c(22.2,
                22.2, 20.2, 20.3, 20.6, 26.6, 23.6, 24.9, 21,
                24.4, 24.5, 16.5, 19.1, 22.7, 18.7, 21.2, 20,
                20.2, 10.8, 20, 18, 22.4, 16.7, 15.3, 21, 23.8,
                18, 16.3, 20.9, 22.5, 15.1, 19.8, 18.3, 19.4,
                20.2, 17.8, 16.3, 18.1, 20.3, 20.5, 18.9, 23,
                20, 19.5, 18, 18.2, 19.3)), .Names = c("Frtlty",
            "Agrclt", "Exmntn", "Eductn", "Cathlc", "Infn.M"),
            row.names = c("Courtelary", "Delemont", "Franches-Mnt",
                "Moutier", "Neuveville", "Porrentruy", "Broye",
                "Glane", "Gruyere", "Sarine", "Veveyse", "Aigle",
                "Aubonne", "Avenches", "Cossonay", "Echallens",
                "Grandson", "Lausanne", "La Vallee", "Lavaux",
                "Morges", "Moudon", "Nyone", "Orbe", "Oron",
                "Payerne", "Paysd'enhaut", "Rolle", "Vevey",
                "Yverdon", "Conthey", "Entremont", "Herens",
                "Martigwy", "Monthey", "St Maurice", "Sierre",
                "Sion", "Boudry", "La Chauxdfnd", "Le Locle",
                "Neuchatel", "Val de Ruz", "ValdeTravers", "V. De Geneve",
                "Rive Droite", "Rive Gauche"), class = "data.frame")),
        identicalTo(expected, tol = 1e-6))
}


test.stats.cor.8 <- function() {
    expected <- structure(c(0x1p+0, 0x1.6fb616b80faa6p-3, -0x1.e7ac70681d981p-2, 
		-0x1.528bbb76e6da1p-2, 0x1.f684bda12f685p-3, 0x1.4339115a45581p-2, 
		0x1.6fb616b80faa6p-3, 0x1p+0, -0x1.cd55ae1a054bep-2, -0x1.e797aee973b31p-2, 
		0x1.a4c873badfc84p-3, -0x1.47d6a68bd6979p-4, -0x1.e7ac70681d981p-2, 
		-0x1.cd55ae1a054bep-2, 0x1p+0, 0x1.0ed1b4dfc63eap-1, -0x1.48fc7476ffa59p-2, 
		-0x1.00e110e250695p-5, -0x1.528bbb76e6da1p-2, -0x1.e797aee973b31p-2, 
		0x1.0ed1b4dfc63eap-1, 0x1p+0, -0x1.5b539939cd1dbp-4, -0x1.78be44ff8d67ep-9, 
		0x1.f684bda12f685p-3, 0x1.a4c873badfc84p-3, -0x1.48fc7476ffa59p-2, 
		-0x1.5b539939cd1dbp-4, 0x1p+0, 0x1.c20878d243da8p-5, 0x1.4339115a45581p-2, 
		-0x1.47d6a68bd6979p-4, -0x1.00e110e250695p-5, -0x1.78be44ff8d67ep-9, 
		0x1.c20878d243da8p-5, 0x1p+0), .Dim = c(6L, 6L), .Dimnames = list(
    	c("Fertility", "Agriculture", "Examination", "Education", 
    	"Catholic", "Infant.Mortality"), c("Fertility", "Agriculture", 
    	"Examination", "Education", "Catholic", "Infant.Mortality"
    	))) 
    assertThat(stats:::cor(method = "kendall", x = structure(list(Fertility = c(80.2,
        83.1, 92.5, 85.8, 76.9, 76.1, 83.8, 92.4, 82.4, 82.9,
        87.1, 64.1, 66.9, 68.9, 61.7, 68.3, 71.7, 55.7, 54.3,
        65.1, 65.5, 65, 56.6, 57.4, 72.5, 74.2, 72, 60.5, 58.3,
        65.4, 75.5, 69.3, 77.3, 70.5, 79.4, 65, 92.2, 79.3, 70.4,
        65.7, 72.7, 64.4, 77.6, 67.6, 35, 44.7, 42.8), Agriculture = c(17,
        45.1, 39.7, 36.5, 43.5, 35.3, 70.2, 67.8, 53.3, 45.2,
        64.5, 62, 67.5, 60.7, 69.3, 72.6, 34, 19.4, 15.2, 73,
        59.8, 55.1, 50.9, 54.1, 71.2, 58.1, 63.5, 60.8, 26.8,
        49.5, 85.9, 84.9, 89.7, 78.2, 64.9, 75.9, 84.6, 63.1,
        38.4, 7.7, 16.7, 17.6, 37.6, 18.7, 1.2, 46.6, 27.7),
        Examination = c(15L, 6L, 5L, 12L, 17L, 9L, 16L, 14L,
            12L, 16L, 14L, 21L, 14L, 19L, 22L, 18L, 17L, 26L,
            31L, 19L, 22L, 14L, 22L, 20L, 12L, 14L, 6L, 16L,
            25L, 15L, 3L, 7L, 5L, 12L, 7L, 9L, 3L, 13L, 26L,
            29L, 22L, 35L, 15L, 25L, 37L, 16L, 22L), Education = c(12L,
            9L, 5L, 7L, 15L, 7L, 7L, 8L, 7L, 13L, 6L, 12L, 7L,
            12L, 5L, 2L, 8L, 28L, 20L, 9L, 10L, 3L, 12L, 6L,
            1L, 8L, 3L, 10L, 19L, 8L, 2L, 6L, 2L, 6L, 3L, 9L,
            3L, 13L, 12L, 11L, 13L, 32L, 7L, 7L, 53L, 29L, 29L),
        Catholic = c(9.96, 84.84, 93.4, 33.77, 5.16, 90.57, 92.85,
            97.16, 97.67, 91.38, 98.61, 8.52, 2.27, 4.43, 2.82,
            24.2, 3.3, 12.11, 2.15, 2.84, 5.23, 4.52, 15.14,
            4.2, 2.4, 5.23, 2.56, 7.72, 18.46, 6.1, 99.71, 99.68,
            100, 98.96, 98.22, 99.06, 99.46, 96.83, 5.62, 13.79,
            11.22, 16.92, 4.97, 8.65, 42.34, 50.43, 58.33), Infant.Mortality = c(22.2,
            22.2, 20.2, 20.3, 20.6, 26.6, 23.6, 24.9, 21, 24.4,
            24.5, 16.5, 19.1, 22.7, 18.7, 21.2, 20, 20.2, 10.8,
            20, 18, 22.4, 16.7, 15.3, 21, 23.8, 18, 16.3, 20.9,
            22.5, 15.1, 19.8, 18.3, 19.4, 20.2, 17.8, 16.3, 18.1,
            20.3, 20.5, 18.9, 23, 20, 19.5, 18, 18.2, 19.3)),
        .Names = c("Fertility", "Agriculture", "Examination",
            "Education", "Catholic", "Infant.Mortality"), class = "data.frame",
        row.names = c("Courtelary", "Delemont", "Franches-Mnt",
            "Moutier", "Neuveville", "Porrentruy", "Broye", "Glane",
            "Gruyere", "Sarine", "Veveyse", "Aigle", "Aubonne",
            "Avenches", "Cossonay", "Echallens", "Grandson",
            "Lausanne", "La Vallee", "Lavaux", "Morges", "Moudon",
            "Nyone", "Orbe", "Oron", "Payerne", "Paysd'enhaut",
            "Rolle", "Vevey", "Yverdon", "Conthey", "Entremont",
            "Herens", "Martigwy", "Monthey", "St Maurice", "Sierre",
            "Sion", "Boudry", "La Chauxdfnd", "Le Locle", "Neuchatel",
            "Val de Ruz", "ValdeTravers", "V. De Geneve", "Rive Droite",
            "Rive Gauche"))), identicalTo(expected, tol = 1e-6))
}
