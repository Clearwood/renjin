
library(stats)
library(hamcrest)


presidents <- structure(c(
    NA, 87, 82, 75, 63, 50, 43, 32, 35, 60, 54, 55, 36,  39, NA, NA, 69, 57, 57, 51, 45, 37, 46,
    39, 36, 24, 32, 23, 25,  32, NA, 32, 59, 74, 75, 60, 71, 61, 71, 57, 71, 68, 79, 73, 76,  71, 67, 75, 79, 62,
    63, 57, 60, 49, 48, 52, 57, 62, 61, 66, 71,  62, 61, 57, 72, 83, 71, 78, 79, 71, 62, 74, 76, 64, 62, 57, 80,  73,
    69, 69, 71, 64, 69, 62, 63, 46, 56, 44, 44, 52, 38, 46, 36,  49, 35, 44, 59, 65, 65, 56, 66, 53, 61, 52, 51, 48,
    54, 49, 49,  61, NA, NA, 68, 44, 40, 27, 28, 25, 24, 24), .Tsp = c(1945, 1974.75,  4), class = "ts")


expected <- structure(list(
    acf = structure(c(
        1, 0.768374619253825, 0.660321241161441,  0.483664020044407, 0.396737652465497, 0.249674787940034,
        0.189005725865775,  0.144656388291015, 0.131304939568644, 0.0451494182932944, 0.0309550023393839,
        0.00544254500196625, 0.048414007976224, 0.0319042652383731, 0.0561414855666649,  0.0172246974716314,
        -0.00433815634076634, -0.0403773538868629,  -0.04648147736939, -0.064820022064282, -0.050948761113749),
        .Dim = c(21L,  1L, 1L)),
    type = "correlation",
    n.used = 120L,
    lag = structure(c(0,  0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75, 3, 3.25,
                    3.5, 3.75, 4, 4.25, 4.5, 4.75, 5),
                    .Dim = c(21L, 1L, 1L)),
    series = "presidents",
    snames = NULL),
     .Names = c("acf", "type", "n.used", "lag", "series", "snames"),
     class = "acf")

actual <- acf(presidents, na.action = na.pass, plot = FALSE)

assertThat(actual, identicalTo(expected, tol = 1e-3))