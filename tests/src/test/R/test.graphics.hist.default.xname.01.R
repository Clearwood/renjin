#
# Renjin : JVM-based interpreter for the R language for the statistical analysis
# Copyright Â© 2010-2018 BeDataDriven Groep B.V. and contributors
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, a copy is available at
# https://www.gnu.org/licenses/gpl-2.0.txt
#

library(hamcrest)

f <- function(x) {
    # this is how the string value of xname slot is generated by graphics::hist() function
    xname <- paste(deparse(substitute(x), 500), collapse="\n")
    r <- structure(list(xname = xname))
    r
}

 expected <- structure(list(xname = "c(1.59782823161656, 3.33229847476224, 3.0708725325018, 2.57443295190736, 6.77648153234793, 2.84317998019559, 4.77980981648408, 4.20133598720285, 3.62030899967596, 2.52365299813383, 4.87884299684008, 2.32562012271169, 10.1759434389342, 2.81536998183695, 0.699360057678276, 2.71909789133398, 2.35478363205471, 4.3194834959823, 4.34721638033593, 3.73754153924096, 5.02072791803389, 4.1526902900875, 2.19988941199396, 3.68587047832306, 4.56625828447379, 3.88398833957977, 3.98078822475909, 0.923103306393228, \n    3.10158113622362, 2.85668515726777, 1.80232610064564, 1.21037359642907, 7.477529247048, 2.97798147821492, 2.16287037366231, 1.3421543048371, 3.25638224702276, 1.50773758878451, 2.51801661804104, 1.41142120043334, 0.829391032003964, 7.6368594852486, 16.6302925233611, 2.27448675760714, 1.771987649167, 0.494730366775669, 1.76396625260564, 5.37146930364381, 1.6524618423861, 7.01196127638178, 16.9767672308456, 3.21432906266582, 1.62031222388773, 6.52534624506516, 1.05801709822357, 4.83038200110289, \n    2.86679189118722, 3.67387431383088, 2.48850798730332, 8.01074601911254, )"), .Names = "xname")

# example test case demostrating difference in hist()$xname between GNU R and Renjin
#
#assertThat(f(x=c(1.59782823161656, 3.33229847476224, 3.0708725325018, 2.57443295190736, 6.77648153234793, 2.84317998019559, 4.77980981648408, 4.20133598720285,
#               3.62030899967596, 2.52365299813383, 4.87884299684008, 2.32562012271169, 10.1759434389342, 2.81536998183695, 0.699360057678276, 2.71909789133398,
#               2.35478363205471, 4.3194834959823, 4.34721638033593, 3.73754153924096, 5.02072791803389, 4.1526902900875, 2.19988941199396, 3.68587047832306,
#               4.56625828447379, 3.88398833957977, 3.98078822475909, 0.923103306393228, 3.10158113622362, 2.85668515726777, 1.80232610064564, 1.21037359642907,
#               7.477529247048, 2.97798147821492, 2.16287037366231, 1.3421543048371, 3.25638224702276, 1.50773758878451, 2.51801661804104, 1.41142120043334,
#               0.829391032003964, 7.6368594852486, 16.6302925233611, 2.27448675760714, 1.771987649167, 0.494730366775669, 1.76396625260564, 5.37146930364381,
#               1.6524618423861, 7.01196127638178, 16.9767672308456, 3.21432906266582, 1.62031222388773, 6.52534624506516, 1.05801709822357, 4.83038200110289,
#               2.86679189118722, 3.67387431383088, 2.48850798730332, 8.01074601911254 )) ,  identicalTo( expected) )
#